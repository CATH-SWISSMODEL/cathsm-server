(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{205:function(e,t,n){e.exports=n(387)},210:function(e,t,n){},212:function(e,t,n){},387:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(22),s=n.n(o),c=(n(210),n(15)),l=n(19),i=n(18),u=n(16),h=n(17),d=(n(212),n(82)),m=n.n(d),p=n(14),f=n(66),b=n.n(f),y=n(35),g=n.n(y),v=n(23),E=n.n(v),S=n(24),k=n.n(S),C=n(31),j=n.n(C),q=n(149),O=n.n(q);var R=Object(p.withStyles)({root:{flexGrow:1},grow:{flexGrow:1},menuButton:{marginLeft:-12,marginRight:20}})(function(e){var t=e.classes;return r.a.createElement("div",{className:t.root},r.a.createElement(b.a,{position:"static"},r.a.createElement(g.a,null,r.a.createElement(j.a,{className:t.menuButton,color:"inherit","aria-label":"Menu"},r.a.createElement(O.a,null)),r.a.createElement(E.a,{variant:"h6",color:"inherit",className:t.grow},"CATH-SWISSMODEL"),r.a.createElement(k.a,{color:"inherit"},"Login"))))}),T=n(8),I=n(78),A=n.n(I),w=n(79),P=n.n(w),D=n(80),L=n.n(D),F=n(81),_=n.n(F),N=n(27),x=n.n(N),M=n(67),G=n.n(M),V=n(42),H=n.n(V),B=n(68),Q=n.n(B),W=n(70),Y=n.n(W),K=n(69),J=n.n(K),z=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={error:!1,errorMessage:null,queryFasta:""},n._handleExampleSequenceClick=n._handleExampleSequenceClick.bind(Object(T.a)(Object(T.a)(n))),n._handleTextFieldChange=n._handleTextFieldChange.bind(Object(T.a)(Object(T.a)(n))),n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"_handleExampleSequenceClick",value:function(e){var t="\n>tr|A0A0Q0Y989|A0A0Q0Y989_9BACI\nMNDFHRDTWAEVDLDAIYDNVANLRRLLPDDTHIMAVVKANAYGHGDVQVARTALEAGAS\nRLAVAFLDEALALREKGIEAPILVLGASRPADAALAAQQRIALTVFRSDWLEEASALYSG\nPFPIHFHLKMDTGMGRLGVKDEEETKRIVALIERHPHFVLEGVYTHFATADEVNTDYFSY\nQYTRFLHMLEWLPSRPPLVHCANSAASLRFPDRTFNMVRFGIAMYGLAPSPGIKPLLPYP\nLKEAFSLHSRLVHVKKLQPGEKVSYGATYTAQTEEWIGTIPIGYADGWLRRLQHFHVLVD\nGQKAPIVGRICMDQCMIRLPGPLPVGTKVTLIGRQGDEVISIDDVARHLETINYEVPCTI\nSYRVPRIFFRHKRIMEVRNAIGRGESSA".trim();console.log("setting: sequence ",t),this.setSequenceFromFasta(t)}},{key:"setError",value:function(e){this.setState({error:!0,errorMessage:e})}},{key:"_handleTextFieldChange",value:function(e){var t=e.target.value;this.setSequenceFromFasta(t)}},{key:"setSequenceFromFasta",value:function(e){if(this.setState({queryFasta:e}),""!==(e=e.trim())){var t=e.split("\n"),n=t.shift();if(!n.startsWith(">"))return this.setError("Expected FASTA header to start with '>'");var a=/^>(\S+)/,r=n.match(a);if(!r)return this.setError("Failed to parse ID from FASTA header '".concat(n,"'"));var o=r[1],s="";t.forEach(function(e,t){e.match(a)||(s+=e.trim())}),console.log("Calling onChange with seq details",this.props,o,s),this.props.onChange(o,s)}else this.setState({error:!1,errorMessage:null,queryId:null,querySequence:null})}},{key:"getFasta",value:function(){return this.state.queryId&&this.state.querySequence?">"+this.state.queryId+"\n"+this.state.querySequence+"\n":void 0}},{key:"renderError",value:function(){}},{key:"render",value:function(){var e=this.props.classes,t=this.state.errorMessage?this.state.errorMessage:"Protein sequence should be in FASTA format";return r.a.createElement("div",{className:e.root},r.a.createElement(H.a,{container:!0,spacing:24},r.a.createElement(H.a,{item:!0,xs:8},r.a.createElement(G.a,{InputProps:{classes:{input:e.querySequenceInput}},className:e.querySequence,id:"query-sequence",label:"Query Protein Sequence",placeholder:"Paste your query protein sequence here",helperText:t,multiline:!0,autoFocus:!0,value:this.state.queryFasta,error:this.state.error,required:!0,fullWidth:!0,margin:"normal"})),r.a.createElement(H.a,{item:!0,xs:4},r.a.createElement(Q.a,{className:e.card},r.a.createElement(J.a,null,r.a.createElement(E.a,null,"Copy/paste a protein sequence into this form then click 'Next'.")),r.a.createElement(Y.a,null,r.a.createElement(k.a,{size:"small",color:"primary",onClick:this._handleExampleSequenceClick},"Example Sequence"),r.a.createElement(k.a,{size:"small",color:"primary"},"Learn More"))))))}}]),t}(r.a.Component),U=Object(p.withStyles)(function(e){return{container:{display:"flex",flexWrap:"wrap"},helpTitle:{fontSize:14},querySequence:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit},querySequenceInput:{fontFamily:"Consolas, Monaco, Lucida Console, Liberation Mono, DejaVu Sans Mono, Bitstream Vera Sans Mono, Courier New, monospace",fontSize:12,lineHeight:1.2}}})(z),X=n(150),$=n(5),Z=n.n($),ee=n(73),te=n.n(ee),ne=n(74),ae=n.n(ne),re=n(26),oe=n.n(re),se=n(71),ce=n.n(se),le=n(77),ie=n.n(le),ue=n(50),he=n.n(ue),de=n(72),me=n.n(de),pe=n(75),fe=n.n(pe),be=n(76),ye=n.n(be),ge=n(43),ve=n.n(ge),Ee=n(151),Se=n.n(Ee),ke=n(152),Ce=n.n(ke),je=n(30),qe=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.width,a=e.residueLength,o=e.segments,s=a/n,c={width:n};return r.a.createElement("div",{className:t.root,style:c},o.map(function(e){var t=e.id,n=e.start,a={width:(e.end-n)*s+"%",left:n*s+"%"};return console.log("ScanMatchFigure.style: ",e,a),r.a.createElement("span",{key:t,style:a})}))}}]),t}(r.a.Component);qe.defaultProps={width:250};var Oe=Object(p.withStyles)(function(e){return{root:{position:"relative",display:"block",height:2,"background-color":"#ddd"},hsp:{height:7,position:"absolute","background-color":"#c00"}}})(qe);function Re(e,t,n){return t[n]<e[n]?-1:t[n]>e[n]?1:0}var Te=[{id:"funfam",numeric:!1,label:"Match"},{id:"description",numeric:!1,label:"FunFam Description"},{id:"members",numeric:!0,label:"Domains"},{id:"features",numeric:!1,label:"Features"},{id:"query_region",numeric:!1,label:"Location of matches"},{id:"evalue",numeric:!0,label:"E-value"}],Ie=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).createSortHandler=function(e){return function(t){n.props.onRequestSort(t,e)}},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.order,a=t.orderBy;return r.a.createElement(ce.a,null,r.a.createElement(he.a,null,Te.map(function(t){return r.a.createElement(oe.a,{key:t.id,numeric:t.numeric,padding:t.disablePadding?"none":"default",sortDirection:a===t.id&&n},r.a.createElement(ve.a,{title:"Sort",placement:t.numeric?"bottom-end":"bottom-start",enterDelay:300},r.a.createElement(me.a,{active:a===t.id,direction:n,onClick:e.createSortHandler(t.id)},t.label)))},this)))}}]),t}(r.a.Component),Ae=function(e){var t=e.numSelected,n=e.classes;return r.a.createElement(g.a,{className:Z()(n.root,Object(X.a)({},n.highlight,t>0))},r.a.createElement("div",{className:n.title},t>0?r.a.createElement(E.a,{color:"inherit",variant:"subtitle1"},t," selected"):r.a.createElement(E.a,{variant:"h6",id:"tableTitle"},"Domain Matches")),r.a.createElement("div",{className:n.spacer}),r.a.createElement("div",{className:n.actions},t>0?r.a.createElement(ve.a,{title:"Delete"},r.a.createElement(j.a,{"aria-label":"Delete"},r.a.createElement(Se.a,null))):r.a.createElement(ve.a,{title:"Filter list"},r.a.createElement(j.a,{"aria-label":"Filter list"},r.a.createElement(Ce.a,null)))))};Ae=Object(p.withStyles)(function(e){return{root:{paddingRight:e.spacing.unit},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(je.lighten)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},spacer:{flex:"1 1 100%"},actions:{color:e.palette.text.secondary},title:{flex:"0 0 auto"}}})(Ae);var we=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={order:"asc",orderBy:"evalue",selected:[],page:0,rowsPerPage:25},n.handleRequestSort=function(e,t){var a=t,r="desc";n.state.orderBy===t&&"desc"===n.state.order&&(r="asc"),n.setState({order:r,orderBy:a})},n.handleClick=function(e,t){var a=n.state.selected,r=a.indexOf(t),o=[];-1===r?o=o.concat(a,t):0===r?o=o.concat(a.slice(1)):r===a.length-1?o=o.concat(a.slice(0,-1)):r>0&&(o=o.concat(a.slice(0,r),a.slice(r+1))),n.setState({selected:o})},n.handleChangePage=function(e,t){n.setState({page:t})},n.handleChangeRowsPerPage=function(e){n.setState({rowsPerPage:e.target.value})},n.isSelected=function(e){return-1!==n.state.selected.indexOf(e)},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.scanResult,n=e.queryId,a=e.querySequence;this.setState({scanResult:t,queryId:n,querySequence:a})}},{key:"render",value:function(){var e=this,t=this.props.classes,n=this.state,a=n.scanResult,o=n.order,s=n.orderBy,c=n.selected,l=n.rowsPerPage,i=n.page,u=n.radio,h=n.querySequence,d=a?a.hits:[],m=d.map(function(e){return{id:e.matchId,funfam:e.matchId,description:e.matchDescription,members:e.funfamMembers,uniq_ec_terms:e.matchEcCount,uniq_go_terms:e.matchGoCount,evalue:e.significance,segments:e.hsps.map(function(e,t){return{id:t,start:e.queryStart,end:e.queryEnd}})}});return r.a.createElement(x.a,{className:t.root},r.a.createElement(Ae,{numSelected:c.length}),r.a.createElement("div",{className:t.tableWrapper},r.a.createElement(te.a,{className:t.table,"aria-labelledby":"tableTitle"},r.a.createElement(Ie,{numSelected:c.length,order:o,orderBy:s,onRequestSort:this.handleRequestSort,rowCount:d.length}),r.a.createElement(ae.a,null,function(e,t){var n=e.map(function(e,t){return[e,t]});return n.sort(function(e,n){var a=t(e[0],n[0]);return 0!==a?a:e[1]-n[1]}),n.map(function(e){return e[0]})}(m,function(e,t){return"desc"===e?function(e,n){return Re(e,n,t)}:function(e,n){return-Re(e,n,t)}}(o,s)).slice(i*l,i*l+l).map(function(n){var a=e.isSelected(n.id);return r.a.createElement(he.a,{hover:!0,onClick:function(t){return e.handleClick(t,n.id)},role:u?"radio":"checkbox","aria-checked":a,tabIndex:-1,key:n.id,selected:a},r.a.createElement(oe.a,{component:"th",scope:"row"},n.funfam),r.a.createElement(oe.a,null,n.description),r.a.createElement(oe.a,null,n.members),r.a.createElement(oe.a,null,n.uniq_ec_terms&&r.a.createElement(fe.a,{badgeContent:n.uniq_ec_terms,color:"primary",className:t.ec},r.a.createElement(ye.a,{label:"EC",className:t.ec}))),r.a.createElement(oe.a,null,r.a.createElement(Oe,{width:250,residueLength:h.length,segments:n.segments})),r.a.createElement(oe.a,{numeric:!0},n.evalue))})))),r.a.createElement(ie.a,{rowsPerPageOptions:[10,25,50],component:"div",count:m.length,rowsPerPage:l,page:i,backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}))}}]),t}(r.a.Component),Pe=Object(p.withStyles)(function(e){return{root:{width:"100%",marginTop:1*e.spacing.unit},table:{minWidth:1020},tableWrapper:{overflowX:"auto"}}})(we),De=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state,t=e.data,n=e.loaded,a=e.placeholder;return n?t:r.a.createElement("p",null,a)}}]),t}(a.Component),Le=Object(p.withStyles)(function(e){return{root:{flexGrow:1,padding:2*e.spacing.unit}}})(De),Fe=n(112),_e=n.n(Fe),Ne=n(51),xe=n.n(Ne),Me=n(83),Ge=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;console.log("RemoteDataProvider().componentDidMount");var t=this.props.interval;this.timer=null,this.fetchData(),t&&(console.log("RemoteDataProvider().componentDidMount.setInterval"),this.timer=setInterval(function(){return e.fetchData()},t))}},{key:"componentWillUnmount",value:function(){console.log("RemoteDataProvider().componentWillUnmount"),clearInterval(this.timer)}},{key:"fetchData",value:function(){var e=this,t=this.props.endpoint,n=this.props.authToken,a=this.props.data,r=this.props.method,o={method:r,headers:{Accept:"application/json","Content-Type":"application/json"}};return n&&(o.headers.Authorization="token ".concat(n)),a&&(o.body=JSON.stringify(a)),console.log("Submitting data to ".concat(t,": method=").concat(r,", auth=").concat(n,", data=").concat(a),o),fetch(t,o).then(function(e){return Promise.all([e.ok,e.json()])}).then(function(t){var n=Object(Me.a)(t,2),a=n[0],r=n[1];if(!a){var o=r.non_field_errors?r.non_field_errors:"Unexpected error";throw Error(o)}e.props.onComplete(r)}).catch(function(t){var n="RemoteDataProvider failed to get data: ".concat(t);console.error(n),e.props.onError(n)})}},{key:"render",value:function(){return null}}]),t}(a.Component);Ge.defaultProps={method:"GET"};var Ve=Ge,He=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.getAuthTokenAsync()}},{key:"getAuthTokenAsync",value:function(){var e=this,t={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:this.props.username,password:this.props.password})};return fetch(this.props.endpoint,t).then(function(e){return Promise.all([e.ok,e.json()])}).then(function(t){var n=Object(Me.a)(t,2),a=n[0],r=n[1];if(!a){var o=r.non_field_errors?r.non_field_errors:"Unexpected error";throw Error(o)}var s=r.token;if("string"!==typeof s)throw Error("failed to get token from response json",r);e.setState(function(){return{authToken:s}}),e.props.onChange(s)}).catch(function(t){var n="Failed to get auth token: ".concat(t);console.error(n),e.props.onError(n)})}},{key:"render",value:function(){return null}}]),t}(a.Component),Be=Object(p.withStyles)(function(e){return{root:{flexGrow:1}}})(He),Qe=n(153),We=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={message:"Waiting for message to be set",error:!1,authToken:null,taskId:!1,completed:!1},n.checkAttempts=0,n.handleError=n.handleError.bind(Object(T.a)(Object(T.a)(n))),n.handleAuthToken=n.handleAuthToken.bind(Object(T.a)(Object(T.a)(n))),n.handleSubmitComplete=n.handleSubmitComplete.bind(Object(T.a)(Object(T.a)(n))),n.handleCheckComplete=n.handleCheckComplete.bind(Object(T.a)(Object(T.a)(n))),n.handleResultComplete=n.handleResultComplete.bind(Object(T.a)(Object(T.a)(n))),n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"getEndpoint",value:function(e,t){var n=e+"Endpoint",a=this.props.apiBase,r=this.props[n];if(!r)throw Error("failed to get endpoint for type ".concat(e),this.props);var o=a?a+r:r;return t&&(o=o.replace("<id>",t)),o}},{key:"handleError",value:function(e){this.setState({error:!0,message:e}),this.props.onError&&this.props.onError(e)}},{key:"handleAuthToken",value:function(e){console.log("handleAuthToken: ".concat(e)),this.setState({authToken:e,message:"Received Auth Token"})}},{key:"renderAuth",value:function(){var e=this.getEndpoint("authToken");return console.log("Auth.endpoint",e),r.a.createElement(Be,{endpoint:e,username:this.props.username,password:this.props.password,onError:this.handleError,onChange:this.handleAuthToken})}},{key:"handleSubmitComplete",value:function(e){console.log("handleSubmitComplete: ",e);var t=this.props.taskIdFromSubmit(e);t?(this.setState({taskId:t,message:"Submitted"}),this.props.onSubmitResponse&&this.props.onSubmitResponse(e)):this.handleError("Failed to get Task ID from response")}},{key:"renderSubmit",value:function(){var e=this.getEndpoint("submit"),t=this.state.authToken,n=this.props.submitData;return r.a.createElement(Ve,{key:"remote-data-provider-submit",endpoint:e,method:"POST",authToken:t,data:n,onError:this.handleError,onComplete:this.handleSubmitComplete})}},{key:"handleCheckComplete",value:function(e){if(console.log("handleCheckComplete: ",e,this.checkAttempts),this.props.onCheckResponse&&this.props.onCheckResponse(e),this.props.isCompleteFromCheck(e))this.setState({completed:!0,message:"Complete"});else{this.setState({message:"Checking..."});var t=this.props.checkMaxAttempts;if(console.log("handleCheckComplete",this.checkAttempts,t),this.checkAttempts++>t){var n="Exceeded maximum number of attempts (".concat(t,") when checking for results to finish.");return this.handleError(n,e)}}}},{key:"renderCheck",value:function(){var e=this.state.authToken,t=this.state.taskId,n=this.getEndpoint("check",t),a=this.props.checkInterval;return r.a.createElement(Ve,{key:"remote-data-provider-check",authToken:e,endpoint:n,interval:a,onError:this.handleError,onComplete:this.handleCheckComplete})}},{key:"handleResultComplete",value:function(e){console.log("handleResultComplete: ".concat(e)),this.setState({message:"Success"}),this.props.onResultResponse(e)}},{key:"renderResult",value:function(){var e=this.state.authToken,t=this.state.taskId,n=this.getEndpoint("result",t);return r.a.createElement(Ve,{key:"remote-data-provider-result",authToken:e,endpoint:n,onError:this.handleError,onComplete:this.handleResultComplete})}},{key:"renderError",value:function(){var e=this.state.message;return console.error("Error: ",e,this.state),"Error: ".concat(e)}},{key:"render",value:function(){var e=this.props.classes,t=this.state.error,n=this.state.authToken,a=this.state.taskId,o=this.state.completed,s=this.state.message,c="",l=r.a.createElement(xe.a,{variant:"query"});return t?(c=this.renderError(),l=r.a.createElement(xe.a,{variant:"determinate",value:100,classes:{colorPrimary:_e.a[500]}})):n?a?o?(c=this.renderResult(),l=null):c=this.renderCheck():c=this.renderSubmit():c=this.renderAuth(),console.log("render: error=".concat(t," authToken=").concat(n," taskId=").concat(a," completed=").concat(o),this.state),r.a.createElement("div",{className:e.root},s&&r.a.createElement(Qe.a,null,s),l,c)}}]),t}(a.Component);We.defaultProps={checkInterval:2e3,checkMaxAttempts:50};var Ye=Object(p.withStyles)(function(e){return{root:{width:"100%"}}})(We),Ke=function(e){function t(e){var n;Object(c.a)(this,t),n=Object(i.a)(this,Object(u.a)(t).call(this,e));var a=e.queryStart,r=e.queryEnd,o=e.matchStart,s=e.matchEnd;return n.queryStart=a,n.queryEnd=r,n.matchStart=o,n.matchEnd=s,n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return null}}]),t}(r.a.Component),Je=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(i.a)(this,Object(u.a)(t).call(this,e))).matchHasStructure=function(){return"cath"===n.repSourceId},n.matchId=e.matchId,n.matchDescription=e.matchDescription,n.matchLength=e.matchLength,n.matchSuperfamilyId=e.matchSuperfamilyId,n.significance=e.significance,n.matchEcCount=e.matchEcCount,n.matchGoCount=e.matchGoCount,n.matchFunfamMembers=e.matchFunfamMembers,n.repSourceId=e.repSourceId,n.hsps=e.hsps.map(function(e){return new Ke(e)}),n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return null}}]),t}(r.a.Component),ze=function(e){function t(e){var n;Object(c.a)(this,t),n=Object(i.a)(this,Object(u.a)(t).call(this,e));var a=e.queryId,r=e.queryLength,o=e.hits;return n.queryId=a,n.queryLength=r,n.hits=o,o.length&&(n.hits=o.map(function(e){return new Je(e)})),n}return Object(h.a)(t,e),t}(r.a.Component);ze.defaultProps={hits:[]};var Ue=ze,Xe=function(e){function t(e){var n;Object(c.a)(this,t),n=Object(i.a)(this,Object(u.a)(t).call(this,e));var a=e||{},r=a.queryId,o=a.querySequence,s=a.results;return n.queryId=r,n.querySequence=o,n.results=s||[],s&&s.length&&(n.results=s.map(function(e){return new Ue(e)})),n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return null}}]),t}(r.a.Component);function $e(e,t){var n=null;if("object"!==typeof e)n="data is not an object: ".concat(JSON.stringify(e));else{var a=e["py/object"];"undefined"===typeof a?n="data does not have 'py/object' field: ".concat(JSON.stringify(e)):a!==t&&(n="wrong py/object (expected ".concat(t,", got ").concat(a,")"))}if(n)throw Error("assertPyObject failed: ".concat(n));return!0}function Ze(e){$e(e,"cathpy.funfhmmer.ResultResponse"),console.log("data: ",JSON.stringify(e).substr(0,200),"---8<---",JSON.stringify(e).substr(-200));var t=function(e){var t=e.split("\n");if(!t[0].startsWith(">"))throw Error("failed to parse fasta (header line does not start with '>'): ".concat(t[0]));return{id:t.shift().substr(1),seq:t.map(function(e){return e.trim()}).join("")}}(e.query_fasta),n=e.funfam_scan;$e(n,"cathpy.models.Scan");var a=n.results?n.results:[],r={queryId:t.id,querySequence:t.seq,featureCols:e.featureCols,results:a.map(function(e){$e(e,"cathpy.models.ScanResult");var t=e.hits?e.hits:[];return{queryId:e.query_id,queryLength:e.query_length,hits:t.map(function(e){$e(e,"cathpy.models.ScanHit");var t=e.hsps?e.hsps:[],n=e.data?e.data:{};return{matchId:e.match_name,matchLength:e.match_length,matchDescription:e.match_description,matchSuperfamilyId:e.match_cath_id?e.match_cath_id.id:void 0,significance:e.significance,matchEcCount:n.ec_term_count,matchGoCount:n.go_term_count,matchFunfamMembers:n.funfam_members,repSourceId:n.rep_source_id,hsps:t.map(function(e){return $e(e,"cathpy.models.ScanHsp"),{queryStart:e.query_start,queryEnd:e.query_end,matchStart:e.hit_start,matchEnd:e.hit_end}})}})}})};return new Xe(r)}var et=[{id:"query-sequence",label:"Query Sequence",dataClass:"QuerySequence"},{id:"select-template",label:"Select Template",resultClass:"SelectTemplateTable",providerClass:"SubmitCheckResultProvider",providerProps:{apiBase:"http://localhost:8000/",authTokenEndpoint:"api/api-auth-token/",submitEndpoint:"api/select-template/",checkEndpoint:"api/select-template/<id>/",resultEndpoint:"api/select-template/<id>/results",taskIdFromSubmit:function(e){return e.uuid},isCompleteFromCheck:function(e){return"success"===e.status},username:"apiuser",password:"apiuserpassword"},providerHandles:{onError:"handleTemplateError",onSubmitResponse:"handleTemplateSubmit",onCheckResponse:"handleTemplateCheck",onResultResponse:"handleTemplateResult"}},{id:"model-structure",label:"Model Structure",resultClass:"ModelStructure",providerClass:"SubmitCheckResultProvider",providerProps:{apiBase:"http://beta.swissmodel.expasy.org/",authTokenEndpoint:"api/api-auth-token/",submitEndpoint:"api/alignment/",checkEndpoint:"api/alignment/<id>/status",resultEndpoint:"api/alignment/<id>/",taskIdFromSubmit:function(e){return e.uuid},isCompleteFromCheck:function(e){return"success"===e.status},username:"ian",password:"4cathuse"},providerHandles:{onError:"handleModelError",onSubmitResponse:"handleModelSubmit",onCheckResponse:"handleModelCheck",onResultResponse:"handleModelResult"}}],tt=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(i.a)(this,Object(u.a)(t).call(this,e))).handleNext=function(e){console.log("handleNext: ",e,e.target),n.setState(function(e){return{activeStep:e.activeStep+1}})},n.handleBack=function(){n.setState(function(e){return{activeStep:e.activeStep-1}})},n.handleReset=function(){n.setState({activeStep:0})},n.state={activeStep:0,queryId:null,querySequence:null,taskId:null,templateError:null,templateScanResult:null},n.handleChangeSequence=n.handleChangeSequence.bind(Object(T.a)(Object(T.a)(n))),n.handleTemplateError=n.handleTemplateError.bind(Object(T.a)(Object(T.a)(n))),n.handleTemplateSubmit=n.handleTemplateSubmit.bind(Object(T.a)(Object(T.a)(n))),n.handleTemplateCheck=n.handleTemplateCheck.bind(Object(T.a)(Object(T.a)(n))),n.handleTemplateResult=n.handleTemplateResult.bind(Object(T.a)(Object(T.a)(n))),n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"handleChangeSequence",value:function(e,t){console.log("Setting query sequence",e,t),this.setState({queryId:e,querySequence:t})}},{key:"renderQuerySequence",value:function(){var e=this.state.queryId,t=this.state.querySequence;return r.a.createElement(U,{queryId:e,querySequence:t,onChange:this.handleChangeSequence})}},{key:"getStepConfigById",value:function(e){return et.find(function(t){return t.id===e})}},{key:"handleTemplateError",value:function(e){console.log("handleTemplateError",e),this.setState({templateError:!0})}},{key:"handleTemplateSubmit",value:function(e){console.log("handleTemplateSubmit",e)}},{key:"handleTemplateCheck",value:function(e){console.log("handleTemplateCheck",e)}},{key:"handleTemplateResult",value:function(e){console.log("handleTemplateResult",e);var t=this.parseTemplateResultData(e);if(t.results.length>1)throw Error("Scan has ".concat(t.results.length," results, expected exactly 1"));var n=t.results[0];this.setState({templateScanResult:n})}},{key:"parseTemplateResultData",value:function(e){console.log("parseTemplateResultData",e);var t=e.results_json,n=JSON.parse(t),a=null;try{a=Ze(n)}catch(r){console.log("failed to parse template results from data",r,e),this.handleTemplateError("failed to parse template results from data")}return console.log("parse: ",t,n.funfam_scan,a),a}},{key:"renderSelectTemplate",value:function(){var e,t=this.getStepConfigById("select-template").providerProps,n=this.state,a=n.queryId,o=n.querySequence,s=n.templateScanResult,c={query_id:a,query_sequence:o};return e=s?r.a.createElement(Pe,{queryId:this.state.queryId,querySequence:this.state.queryId,scanResult:s}):r.a.createElement(Ye,Object.assign({},t,{key:"select-template",submitData:c,onError:this.handleTemplateError,onSubmitResponse:this.handleTemplateSubmit,onCheckResponse:this.handleTemplateCheck,onResultResponse:this.handleTemplateResult})),r.a.createElement("div",null,e)}},{key:"renderModelStructure",value:function(){return r.a.createElement(Le,null)}},{key:"render",value:function(){var e=this,t=this.props.classes,n=this.state.activeStep,a=[{label:"Query Sequence",content:this.renderQuerySequence()},{label:"Select Template",content:this.renderSelectTemplate()},{label:"Model Structure",content:this.renderModelStructure()}];return r.a.createElement("div",{className:t.root},r.a.createElement(A.a,{activeStep:n,orientation:"vertical"},a.map(function(o,s){var c=o.label,l=o.content,i="next"+o.tag;return r.a.createElement(P.a,{key:c},r.a.createElement(L.a,null,c),r.a.createElement(_.a,null,l,r.a.createElement("div",{className:t.actionsContainer},r.a.createElement("div",null,r.a.createElement(k.a,{disabled:0===n,onClick:e.handleBack,className:t.button},"Back"),r.a.createElement(k.a,{variant:"contained",color:"primary",key:i,onClick:e.handleNext,className:t.button},n===a.length-1?"Finish":"Next")))))})),n===a.length&&r.a.createElement(x.a,{square:!0,elevation:0,className:t.resetContainer},r.a.createElement(E.a,null,'All steps completed - you"re finished'),r.a.createElement(k.a,{onClick:this.handleReset,className:t.button},"Reset")))}}]),t}(r.a.Component),nt=Object(p.withStyles)(function(e){return{root:{width:"100%"},button:{marginTop:e.spacing.unit,marginRight:e.spacing.unit},actionsContainer:{marginBottom:2*e.spacing.unit},resetContainer:{padding:3*e.spacing.unit}}})(tt),at=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(m.a,null),r.a.createElement(R,null),r.a.createElement(nt,null))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(at,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[205,2,1]]]);
//# sourceMappingURL=main.7fc64229.chunk.js.map